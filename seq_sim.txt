# you need to read a tree and call it sim_tree

n_branches <- sim_tree.ntips()*2-2

# get the tree length
TL <- sim_tree.treeLength()

# 
clock_rate <- 3 / TL

for ( i in 1:n_branches ) {
   branch_rate[i] <- rlognormal(n=1,clock_rate,sd=0.3)[1]
}

Q <- fnJC(4)

seq ~ dnPhyloCTMC(sim_tree, Q=Q, branchRates=branch_rate, type="DNA", nSites=1000)

writeNexus(seq,file="my_sim_1.nex")

